<?php
	include 'php_files/functions.php';
	session_start();
	clearSessionBools();
	if(isset($_SESSION['usr']) && isset($_SESSION['pswd'])){
		//user logged in proceed
		$_SESSION['api_token']="tok_CcUbJqjQgYboQfYM4DuVHHIjdHuHFtjxlqeb0u9ZxCv";
	}else{
		//not logged in, redirect to login
		header("Location: login.html");
		exit();
	}
?>
<!DOCTYPE html>
<html>
	<head>
	<link rel="stylesheet" type="text/css" href="style.css">
	<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700" rel="stylesheet">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.min.js"></script>
	<script rel="text/javascript" src="nano.js"></script>
	</head>
	
<body>
		<div id="navcontainer">
		
			<div id="navbar">
				<div id="imgcontainer">
					<img id="navlogo" src="resources/AELogo2.png" />
				</div>
				<div id="navmenu">
					<div class="navmenuitem">
						<a class="navmenutext" href="php_files/logoff.php">SIGN OUT</a>
					</div>
					<div class="navmenuitem">
						<a class="navmenutext" href="https://accelentertainment.com">BACK TO MAIN SITE</a>
					</div>
					<div class="clear">
					</div>
				</div>
			</div>
			
		</div>
			
		<div id="accountlistcontainer">
			
			<div id="accountswrapper" class="nano" >
				<div class="content">
					<div class="accountrowempty"></div>
					<div id="ar1" class="accountrow" onclick="changeAccount('ar1')">103 East</div>
					<div id="ar2" class="accountrow" onclick="changeAccount('ar2')">Hucks 365</div>
					<div id="ar3" class="accountrow" onclick="changeAccount('ar3')">Bella's Bistro</div>
					<div id="ar4" class="accountrow" onclick="changeAccount('ar4')">Hucks 386</div>
					<div id="ar5" class="accountrow" onclick="changeAccount('ar5')">Henry's Hotdogs</div>
				</div>
			</div>
		</div>

		<div id="maintablecontainer">
			<div class="containerlabel2">
					<button class="contenttablebutton contentbutton" onclick="changeTab(event, 'contentreports')">VGT Reports</button>
					<button class="noborderradius contentbutton" onclick="changeTab(event, 'contentfoot')">Foot Traffic Data</button>
					<button class="noborderradius contentbutton" onclick="changeTab(event, 'contentabsolute')">Absolute Edge Layout</button>
					<button class="norightborder contentbutton" onclick="changeTab(event, 'contentsettings')">Settings</button>
			</div>
			<div class="clear">
			</div>
			<div id="contentwelcome">Welcome back Mark, select a Location and Menu Option to get started</div>
			<div id="contentreports" class="tabcontent">Linked BI360 Reports show here
			</div>
			<div id="contentfoot" class="tabcontent">
				<div id="currentcountwrap" class="footwraps">
					<div id="currentcountlabel" class="footlabels">Current Count
					</div>
					<div id="currentcountdisplay" class="footdisplay">13
					</div>
				</div>
				<div id="todaytotalwrap" class="footwraps">
					<div id="todaytotallabel" class="footlabels">Today's Total
					</div>
					<div id="todaytotaldisplay" class="footdisplay">43
					</div>
				</div>
				<div id="selecteddatetotalwrap" class="footwraps">
					<div id="selecteddatetotallabel" class="footlabels">Selected Date Total
					</div>
					<div id="selecteddatetotaldisplay" class="footdisplay">785
					</div>
				</div>
				<div id="countgraphwrap">
					<div id="countgraph">
						<canvas id="countcanvas">
						</canvas>
					</div>
				</div>
				
			</div>
			<div id="contentabsolute" class="tabcontent">Field Inputs and iframe example window show here
			</div>
			<div id="contentsettings" class="tabcontent">User/Location settings show here
			</div>
		</div>
		<div class="clear">
		</div>
		
		<script>
			(function updateCount(){
				$.ajax({
					url : 'php_files/currentcount.php', type : 'POST', success: function (result) {
						document.getElementById('currentcountdisplay').innerHTML = result;
						}, error : function() { console.log ('error');}
						}).then(function () {
							setTimeout(updateCount,5000);
							});
			})();
				
			
		</script>
		<script>
			var ctx = document.getElementById("countcanvas").getContext('2d');
			var myChart = new Chart(ctx, {
				type: 'bar',
				data: {
					labels: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
					datasets: [{
						label: 'Traffic Count',
						data: [12, 19, 3, 5, 2, 3],
						backgroundColor: [
							'rgba(255, 99, 132, 0.2)',
							'rgba(54, 162, 235, 0.2)',
							'rgba(255, 206, 86, 0.2)',
							'rgba(75, 192, 192, 0.2)',
							'rgba(153, 102, 255, 0.2)',
							'rgba(255, 159, 64, 0.2)'
						],
						borderColor: [
							'rgba(255,99,132,1)',
							'rgba(54, 162, 235, 1)',
							'rgba(255, 206, 86, 1)',
							'rgba(75, 192, 192, 1)',
							'rgba(153, 102, 255, 1)',
							'rgba(255, 159, 64, 1)'
						],
						borderWidth: 1
					}]
				},
				options: {
					scales: {
						yAxes: [{
							ticks: {
								beginAtZero:true
							}
						}]
					}
				}
			});
		</script>
		<script>
			function changeAccount(accDiv){
				var i, accounts,selectedaccount;
				selectedaccount = document.getElementById(accDiv);
				accounts=document.getElementsByClassName("accountrowselected");
				for(i = 0; i<accounts.length; i++){
					accounts[i].className = accounts[i].className.replace("accountrowselected", "accountrow");
				}
				selectedaccount.className = "accountrowselected";
			}
		</script>
		<script>
			$(".nano").nanoScroller();
		</script>
		<script>
			function changeTab(evt, divname) {
				var i, tabcontent, tabbuttons;
				tabcontent = document.getElementsByClassName("tabcontent");
				for (i = 0; i < tabcontent.length; i++) {
					tabcontent[i].style.display = "none";
					
				}
				tabbuttons = document.getElementsByClassName("contentbutton");
				for (i = 0; i < tabbuttons.length; i++) {
					tabbuttons[i].className = tabbuttons[i].className.replace(" active", "");
				}
				document.getElementById("contentwelcome").style.display = "none";
				document.getElementById(divname).style.display = "block";
				evt.currentTarget.className += " active";
			}
		</script>
		
</body>
</html>